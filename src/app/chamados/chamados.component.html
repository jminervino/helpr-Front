<ng-container *ngIf="chamados$ | async as dataSource; else loading">
  <app-page-header
    title="Lista de chamados"
    actionLabel="Novo chamado"
    actionIcon="add"
    actionRoute="new">
  </app-page-header>

  <div class="page-content">
    <div *ngIf="dataSource.length === 0; else tableBlock" class="data-table-container">
      <app-empty-state
        icon="assignment"
        title="Nenhum chamado encontrado"
        description="Crie um novo chamado para começar"
        actionLabel="Criar chamado"
        actionRoute="new">
      </app-empty-state>
    </div>
    <ng-template #tableBlock>
    <div class="data-table-container">
  <div class="table-responsive">
    <table mat-table [dataSource]="dataSource" [trackBy]="trackById">
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef class="col-id">#</th>
        <td mat-cell *matCellDef="let chamado">{{ chamado.id }}</td>
      </ng-container>
      <ng-container matColumnDef="titulo">
        <th mat-header-cell *matHeaderCellDef>Título</th>
        <td mat-cell *matCellDef="let chamado">{{ chamado.titulo }}</td>
      </ng-container>
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let chamado">
          <app-status-chip [status]="chamado.status">
          </app-status-chip>
        </td>
      </ng-container>
      <ng-container matColumnDef="prioridade">
        <th mat-header-cell *matHeaderCellDef>Prioridade</th>
        <td mat-cell *matCellDef="let chamado">
          <app-prioridade-chip [prioridade]="chamado.prioridade">
          </app-prioridade-chip>
        </td>
      </ng-container>
      <ng-container matColumnDef="observacoes">
        <th mat-header-cell *matHeaderCellDef>Observações</th>
        <td mat-cell *matCellDef="let chamado">{{ chamado.observacoes }}</td>
      </ng-container>
      <ng-container matColumnDef="acoes">
        <th mat-header-cell *matHeaderCellDef>Ações</th>
        <td mat-cell *matCellDef="let element">
          <div class="actions-cell">
            <a mat-icon-button color="primary" routerLink="edit/{{ element.id }}" matTooltip="Editar chamado">
              <mat-icon>edit</mat-icon>
            </a>
            <a mat-icon-button color="accent" routerLink="{{ element.id }}" matTooltip="Visualizar">
              <mat-icon>visibility_on</mat-icon>
            </a>
          </div>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
  </div>
  </ng-template>
  </div>
</ng-container>

<ng-template #loading>
  <app-loader label="Carregando chamados..."></app-loader>
</ng-template>
