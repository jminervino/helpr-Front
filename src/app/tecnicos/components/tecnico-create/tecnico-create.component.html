<div class="page-container--narrow">
  <div class="form-card">
    <h2 class="form-card__title">Novo técnico</h2>
    <form [formGroup]="tecnicoForm" (ngSubmit)="onSubmit()">
      <section formArrayName="perfils" class="section checkbox-section">
        <mat-checkbox class="margin" color="primary" formControlName="0">Admin</mat-checkbox>
        <mat-checkbox class="margin" color="primary" formControlName="1">Cliente</mat-checkbox>
        <mat-checkbox class="margin" color="primary" formControlName="2">Tecnico</mat-checkbox>
      </section>
      <mat-form-field appearance="fill">
        <mat-label>Nome</mat-label>
        <input matInput placeholder="Nome do tecnico" formControlName="nome" required />
        <mat-error *ngIf="tecnicoForm.get('nome')?.errors?.['required']">Campo obrigatório</mat-error>
        <mat-icon matPrefix>person</mat-icon>
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>CPF</mat-label>
        <input matInput mask="000.000.000-00" [dropSpecialCharacters]="false" placeholder="CPF do tecnico"
          formControlName="cpf" required />
        <mat-error *ngIf="tecnicoForm.get('cpf')?.errors?.['required']">Campo obrigatório</mat-error>
        <mat-error *ngIf="tecnicoForm.get('cpf')?.errors?.['mask']">Formato de CPF inválido</mat-error>
        <mat-icon matPrefix>credit_card</mat-icon>
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Email</mat-label>
        <input matInput placeholder="Email do tecnico" formControlName="email" type="email" required />
        <mat-error *ngIf="tecnicoForm.get('email')?.errors?.['required']">Campo obrigatório</mat-error>
        <mat-icon matPrefix>email</mat-icon>
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Senha</mat-label>
        <input matInput [type]="ocultar ? 'password' : 'text'" placeholder="Senha do tecnico" formControlName="senha" required />
        <mat-icon matPrefix>key</mat-icon>
        <button type="button" mat-icon-button matSuffix (click)="ocultar = !ocultar" [attr.aria-label]="'Mostrar/ocultar senha'">
          <mat-icon>{{ ocultar ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error *ngIf="tecnicoForm.get('senha')?.errors?.['required']">Campo obrigatório</mat-error>
        <mat-error *ngIf="tecnicoForm.get('senha')?.errors?.['minlength']">O mínimo são 8 caracteres</mat-error>
      </mat-form-field>
    <span class="mat-error" *ngIf="tecnicoForm.get('perfils')?.errors?.['sometrue']">
      Marque pelo menos uma função para o usuário
    </span>
    <div class="form-card__actions">
      <button mat-button type="button" routerLink="/tecnicos">Cancelar</button>
      <button mat-flat-button color="primary" [disabled]="tecnicoForm.invalid">Criar técnico</button>
    </div>
  </form>
  </div>
</div>